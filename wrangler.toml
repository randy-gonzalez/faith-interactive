# Cloudflare Pages configuration for Faith Interactive
# See: https://developers.cloudflare.com/pages/functions/wrangler-configuration/

name = "fi-platform"
compatibility_date = "2024-12-01"
compatibility_flags = ["nodejs_compat"]

# Pages build output directory
# Note: @cloudflare/next-on-pages uses Vercel's build output format internally,
# then adapts it for Cloudflare. The ".vercel" path is just a build artifact.
pages_build_output_dir = ".vercel/output/static"

# ============================================
# KV Namespace for Rate Limiting (Optional)
# ============================================
# Uncomment after creating KV namespace in Cloudflare dashboard:
# Workers & Pages > KV > Create a namespace
# Then copy the namespace ID here
#
# [[kv_namespaces]]
# binding = "RATE_LIMIT_KV"
# id = "<your-kv-namespace-id>"

# ============================================
# R2 Bucket Binding (Optional)
# ============================================
# You can bind R2 directly or use S3-compatible API via env vars.
# Using env vars (S3_ENDPOINT, S3_ACCESS_KEY_ID, etc.) is simpler
# and works with the existing storage abstraction.
#
# Uncomment to use direct R2 binding instead:
# [[r2_buckets]]
# binding = "MEDIA_BUCKET"
# bucket_name = "fi-media"

# ============================================
# Environment Variables (Non-Secrets)
# ============================================
# Add non-sensitive values here. Secrets should be set in the
# Cloudflare dashboard or via `wrangler secret put`.

[vars]
NODE_ENV = "production"
LOG_LEVEL = "info"
SESSION_DURATION_DAYS = "7"
PASSWORD_RESET_EXPIRATION_HOURS = "1"
RATE_LIMIT_MAX = "100"
RATE_LIMIT_WINDOW_SECONDS = "60"
S3_REGION = "auto"

# ============================================
# Secrets (set via dashboard or CLI)
# ============================================
# These should NOT be in this file. Set them using:
#   wrangler secret put DATABASE_URL
#   wrangler secret put JWT_SECRET
#   wrangler secret put S3_ACCESS_KEY_ID
#   wrangler secret put S3_SECRET_ACCESS_KEY
#
# Or add them in Cloudflare Dashboard:
#   Workers & Pages > [project] > Settings > Environment Variables

# ============================================
# Production vs Preview Environments
# ============================================
# You can override settings per environment:
#
# [env.preview.vars]
# LOG_LEVEL = "debug"
#
# [env.production.vars]
# LOG_LEVEL = "info"
